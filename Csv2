require 'vendor/autoload.php';

use PhpOffice\PhpSpreadsheet\Spreadsheet;
use PhpOffice\PhpSpreadsheet\Writer\Xlsx;

// Crear un nuevo objeto Spreadsheet
$spreadsheet = new Spreadsheet();

// Crear una hoja
$sheet = $spreadsheet->getActiveSheet();
$sheet->setTitle('Incidentes');

// Obtener los datos del array
$data = // AquÃ­ debes agregar el array de datos que proporcionaste

// Filtrar los datos para obtener Incidentes SDK y CAU
$incidentesSDK = array_filter($data, function ($item) {
    return $item['type'] == 'Incidentes SDK';
});

$incidentesCAU = array_filter($data, function ($item) {
    return $item['type'] == 'Incidentes CAU';
});

// Crear la tabla de Incidentes SDK
$sheet->fromArray($incidentesSDK, null, 'A1');
$sheet->setCellValue('A' . (count($incidentesSDK) + 2), 'Tabla de Incidentes SDK');

// Crear una hoja nueva para la tabla de Incidentes CAU
$spreadsheet->createSheet();
$sheetCAU = $spreadsheet->getSheet(1);
$sheetCAU->setTitle('Incidentes CAU');

// Crear la tabla de Incidentes CAU
$sheetCAU->fromArray($incidentesCAU, null, 'A1');
$sheetCAU->setCellValue('A' . (count($incidentesCAU) + 2), 'Tabla de Incidentes CAU');

// Guardar el archivo
$writer = new Xlsx($spreadsheet);
$writer->save('incidentes.xlsx');
