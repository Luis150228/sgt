del siguiente codigo quiero que en lugar de guardar el archivo en una ubicacion determinada se requiere que se descarge y el usuario guarde el archivo donde quiera 

// /*
        $spreadsheet = new Spreadsheet();
        $sheet = $spreadsheet->getActiveSheet();
        $sheet->setTitle('Data');

        // Obtener las claves del primer registro para generar las columnas
        $firstRecord = reset($data);
        $columns = array_keys($firstRecord);

        // Escribir los encabezados de las columnas en la primera fila de la hoja
        $columnIndex = 1;
        foreach ($columns as $column) {
            $cellCoordinate = \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex($columnIndex) . '1';
            $sheet->setCellValue($cellCoordinate, $column);
            $columnIndex++;
        }

        // Escribir los datos en la hoja
        $rowIndex = 2; // Comenzar a partir de la segunda fila, ya que la primera fila contiene los encabezados
        foreach ($data as $record) {
            $columnIndex = 1;
            foreach ($record as $value) {
                $cellCoordinate = \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex($columnIndex) . $rowIndex;
                $sheet->setCellValue($cellCoordinate, $value);

                $statusCell = \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex(array_search('Estatus', $columns) + 1) . $rowIndex;

                // Aplicar formato a toda la fila cuando el campo "Estatus" sea "VENCIDO" (Color de fuente rojo)
                if ($sheet->getCell($statusCell)->getValue() === 'VENCIDO') {
                    $sheet->getStyle($cellCoordinate)->getFont()->getColor()->setRGB('FF0000');
                }

                $columnIndex++;
            }
            $rowIndex++;
        }


        $writer = new Xlsx($spreadsheet);
        $writer->save('../xlsx/' . $namefile . '.xlsx');

        header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
        header('Content-Disposition: attachment;filename="' . $namefile . '.xlsx"');
        header('Cache-Control: max-age=0');

        $writer = \PhpOffice\PhpSpreadsheet\IOFactory::createWriter($spreadsheet, 'Xlsx');
        $writer->save('php://output');
