
dbupdate.js
let data;
if (base !== 'tablero') {
    data = await openFile(base, archivo, tiempo, BarProgressz[i], mnsAlert[i], mnsLoad[i], btnsAlt[i]);
} else if (base === 'tablero') {
    data = processMailFileCom('frm-tablero');
}
console.log(data);


tableroSSuc.js
export const processMailFileCom = (frmTablero) => {
	const frm = document.getElementById(`${frmTablero}`);
	const input = frm.querySelector('input');
	const rangeInput = 'A1:G49';
	const rangeCarrierOut = 'B13:F18';
	// const rangeInput = document.getElementById('rangeInput').value.trim();
	if (!input.files.length || !rangeInput) {
		alert('Selecciona un archivo Excel y especifica un rango.');
		return;
	}

	const reader = new FileReader();
	reader.onload = (event) => {
		const data = new Uint8Array(event.target.result);
		const workbook = XLSX.read(data, { type: 'array' });

		// Lee la primera hoja del archivo Excel
		const sheetName = workbook.SheetNames[0];
		const sheet = workbook.Sheets[sheetName];

		// Convierte el rango seleccionado a HTML
		const range = XLSX.utils.decode_range(rangeCarrierOut);
		const filteredSheet = filterEmptyCells(sheet, range);
		const htmlTable = XLSX.utils.sheet_to_html(filteredSheet);
		const divCarrier = document.createElement('div');
		divCarrier.innerHTML = htmlTable;
		const tbodyCarrierNew = divCarrier.querySelector('tbody');
		const tbodyCarrier = document.getElementById('data-carriers');
		tbodyCarrier.innerHTML = '';
		tbodyCarrier.innerHTML = tbodyCarrierNew.innerHTML;

		const jsonDataTypeInc = XLSX.utils.sheet_to_json(sheet, {
			range: 'E7:F11',
			header: ['type', 'valor'],
		});
		const cellsIncType = document.querySelectorAll('.data-typeInc');
		for (const [i, cellIncType] of cellsIncType.entries()) {
			cellsIncType[i].innerHTML = '';
			cellsIncType[i].innerHTML = jsonDataTypeInc[i].valor;
		}

		const cellContingencia = document.getElementById('contingencia');
		cellContingencia.innerHTML = '';
		const totalLentitud = jsonDataTypeInc[jsonDataTypeInc.length - 1].valor;
		const totalBackup = jsonDataTypeInc[jsonDataTypeInc.length - 2].valor;
		cellContingencia.innerHTML = totalLentitud + totalBackup;

		const jsonDataCommits = XLSX.utils.sheet_to_json(sheet, {
			range: 'B48:F48',
			header: ['valor'],
		});

		const jsonSucFuera = jsonDataCommits[0].valor.trim().split('\r\n');
		const sucOff = document.getElementById('suc-off');
		const sucOffCommit = document.getElementById('sucFuera');
		sucOff.innerHTML = jsonSucFuera.length;
		sucOffCommit.innerHTML = `${jsonSucFuera.join('; ')}`;

		const container = document.getElementById('tableContainer');
		// container.style.display = 'block';
		const tablaSaves = container.innerHTML;

		const tablaSave = {
			code: '200',
			mnj: 'Datos Procesados',
			data: [
				{
					total: 1,
					actualizado: '2025-01-22 15:45:19',
					type: 'tablero',
				},
			],
			tabla: tablaSaves,
		};

		return tablaSave;
		// container.style.display = 'none';

		// Muestra el bot√≥n para generar imagen
		// createImagenTablero();
	};

	reader.readAsArrayBuffer(input.files[0]);
};