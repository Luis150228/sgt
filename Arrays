<?php
require 'vendor/autoload.php'; // Asegúrate de tener instalada la librería PhpSpreadsheet

use PhpOffice\PhpSpreadsheet\Spreadsheet;
use PhpOffice\PhpSpreadsheet\Writer\Xlsx;

// Tu array de datos
$data = array(
    // ... tus datos aquí
);

// Carga el libro de Excel existente
$spreadsheet = \PhpOffice\PhpSpreadsheet\IOFactory::load('ruta/del/tu/libro/excel.xlsx');

// Obtiene la hoja 'stock'
$sheet = $spreadsheet->getSheetByName('stock');

// Borra el contenido de la tabla 'stock_data'
$sheet->setCellValue('A2', ''); // Asegúrate de especificar la celda que coincide con el inicio de tus datos

// Inserta los nuevos datos desde el array
foreach ($data as $row => $rowData) {
    foreach ($rowData as $col => $value) {
        $sheet->setCellValueByColumnAndRow($col + 1, $row + 2, $value); // Suma 1 para ajustar el índice a la base 1 de Excel
    }
}

// Guarda el libro de Excel con los nuevos datos
$writer = new Xlsx($spreadsheet);
$writer->save('ruta/del/tu/libro/excel.xlsx');
