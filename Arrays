$rowIndex = 2; // Comenzar a partir de la segunda fila, ya que la primera fila contiene los encabezados
foreach ($data as $record) {
    $columnIndex = 1;
    foreach ($record as $value) {
        $cellCoordinate = \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex($columnIndex) . $rowIndex;
        $sheet->setCellValue($cellCoordinate, $value);

        // Ajustar el ancho de la columna al contenido
        $sheet->getColumnDimension(\PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex($columnIndex))->setAutoSize(true);

        if ($sheet->getCell($statusCell)->getValue() === 'VENCIDO') {
            // Aplicar formato de fuente roja a toda la fila desde la columna A hasta la Ãºltima columna
            $range = 'A' . $rowIndex . ':' . \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex(count($record)) . $rowIndex;
            $sheet->getStyle($range)->getFont()->getColor()->setRGB('FF0000');
        }

        $columnIndex++;
    }
    $rowIndex++;
}
