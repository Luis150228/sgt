DELIMITER //

CREATE PROCEDURE obtener_resumen_inventario()
BEGIN
  SET SESSION group_concat_max_len = 1000000;

  -- Construir la consulta dinámica para obtener los tipos únicos
  SET @sql = NULL;
  SELECT GROUP_CONCAT(DISTINCT
             'SUM(CASE WHEN tipo = "', tipo, '" THEN stock ELSE 0 END) AS "', tipo, '"'
             ) INTO @sql
  FROM nombre_de_tu_tabla;

  -- Construir la consulta final
  SET @sql = CONCAT(
      'SELECT almacen, ', @sql, '
       FROM nombre_de_tu_tabla
       GROUP BY almacen'
  );

  -- Ejecutar la consulta dinámica
  PREPARE final_query FROM @sql;
  EXECUTE final_query;
  DEALLOCATE PREPARE final_query;
END //

DELIMITER ;
