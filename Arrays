en el siguiente codigo quiero agregar que se ajusten el ancho de la columna al contenido o se autoajuste 

        // Obtener las claves del primer registro para generar las columnas
        $firstRecord = reset($data);
        $columns = array_keys($firstRecord);

        // Establecer estilos para los encabezados (títulos)
        $headerStyle = [
            'font' => ['bold' => true, 'color' => ['rgb' => 'FF0000']],
            'alignment' => ['horizontal' => \PhpOffice\PhpSpreadsheet\Style\Alignment::HORIZONTAL_CENTER],
        ];
        $sheet->getStyle('A1:' . \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex(count($columns)) . '1')->applyFromArray($headerStyle);

        // Fijar la primera fila (encabezados) para que esté siempre visible mientras se desplaza por la hoja
        $sheet->freezePane('A2');

        // Activar autofiltro en la primera fila (encabezados)
        $sheet->setAutoFilter('A1:' . \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex(count($columns)) . '1');
        // Escribir los encabezados de las columnas en la primera fila de la hoja
        $columnIndex = 1;
        foreach ($columns as $column) {
            $cellCoordinate = \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex($columnIndex) . '1';
            $sheet->setCellValue($cellCoordinate, $column);
            $columnIndex++;
        }
