$rowIndex = 2; // Comenzar a partir de la segunda fila, ya que la primera fila contiene los encabezados
foreach ($data as $record) {
    $columnIndex = 1;
    foreach ($record as $value) {
        $cellCoordinate = \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex($columnIndex) . $rowIndex;
        $sheet->setCellValue($cellCoordinate, $value);
        
        if ($sheet->getCell(\PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex($columnIndex) . $rowIndex)->getValue() === 'VENCIDO') {
            // Aplicar formato de fuente roja desde la columna A hasta la Ãºltima columna
            $sheet->getStyle('A' . $rowIndex . ':' . \PhpOffice\PhpSpreadsheet\Cell\Coordinate::stringFromColumnIndex(count($columns)) . $rowIndex)
                  ->getFont()->getColor()->setRGB('FF0000');
        }
        
        $columnIndex++;
    }
    $rowIndex++;
}
